<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–ö</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial; background: #111; color: white; text-align: center; padding: 20px; }
        button { padding: 15px; margin: 10px; font-size: 18px; width: 90%; border-radius: 12px; border: none; background: #0088cc; color: white; }
        img { max-width: 100%; border-radius: 12px; margin: 10px 0; }
        pre { background: #222; padding: 15px; border-radius: 12px; text-align: left; }
    </style>
</head>
<body>
    <h1>üî• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ü–ö</h1>
    <button onclick="takeScreenshot()">üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç</button>
    <button onclick="getSysInfo()">üíª –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–∞</button>
    <button onclick="openShell()">üîß –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É</button>
    <button onclick="shutdownPC()">üî¥ –í—ã–∫–ª—é—á–∏—Ç—å –ü–ö</button>

    <div id="output"></div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        const API_URL = "http://172.18.0.1:8000";  // –ü–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏ –Ω–∞ ngrok URL

        async function takeScreenshot() {
            const img = document.createElement("img");
            img.src = `${API_URL}/screenshot?init_data=${encodeURIComponent(tg.initData)}&t=${Date.now()}`;
            document.getElementById("output").innerHTML = "";
            document.getElementById("output").appendChild(img);
        }

        async function getSysInfo() {
            const res = await fetch(`${API_URL}/sysinfo?init_data=${encodeURIComponent(tg.initData)}`);
            const data = await res.json();
            document.getElementById("output").innerHTML = `
                <pre>
üñ• CPU: ${data.cpu}%
üß† RAM: ${data.ram_percent}% (${data.ram_gb} GB)
üíæ –î–∏—Å–∫: ${data.disk_percent}%
                </pre>`;
        }

        async function openShell() {
            const cmd = prompt("–í–≤–µ–¥–∏ –∫–æ–º–∞–Ω–¥—É:");
            if (!cmd) return;
            const res = await fetch(`${API_URL}/shell?init_data=${encodeURIComponent(tg.initData)}`, {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({command: cmd})
            });
            const data = await res.json();
            document.getElementById("output").innerHTML = `<pre>${data.output || data.error}</pre>`;
        }

        async function shutdownPC() {
            if (confirm("–¢–æ—á–Ω–æ –≤—ã—Ä—É–±–∏—Ç—å –ü–ö?")) {
                await fetch(`${API_URL}/shutdown?init_data=${encodeURIComponent(tg.initData)}`, {method: "POST"});
                alert("–í—ã—Ä—É–±–∞—é —á–µ—Ä–µ–∑ 10 —Å–µ–∫...");
            }
        }
    </script>
</body>
</html>
